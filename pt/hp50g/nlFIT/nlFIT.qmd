---
title: "nlFIT - Ajuste não-linear"
format: html
toc: true
toc-depth: 3
number-sections: true
lang: pt
---

|   Este programa permite efetuar um ajuste não linear por método de Gauss-Newton para uma equação introduzida pelo usuário. O programa foi adaptado do código do programa DATFIT (Coffin, 1995), e encontra-se depositado junto ao portal [hpcalc.org](https://www.hpcalc.org/search.php?query=nlFIT). Possui a seguinte logística e diferenciais:
\

```{r, eval=FALSE}
# Lógica do programa:

1. Entrada de dados direta na pilha como listas, sem necessidade de formulário
   (INFORM);
2. Número de iterações solicitado no input inicial;
3. Só há um input de dados e não dois como no código original;
4. O index para cada iteração é exibido no canto superior esquerdo da tela
   gráfica;
5. Fornece como saída:
     a. matriz de covariância;
     b. valores de parâmetros calculados;
     c. valores de desvio-padrão dos parâmetros;
     d. Chi-quadrado da regressão;
     e. lista de valores de xi;
     f. lista de valores de y_calc
     g. tela gráfica com pontos experimentais;
     f. curva de ajuste não linear sobreposta aos pontos.
6. Utiliza as subrotinas FDER e PGALL do mesmo livro para cálculo da derivada simbólica da 
     função e para eliminar variáveis previamente armazenadas, respectivamente.
     (o programa original necessita de 3 subprogramas para rodar);
7. Plota os dados experimentais com rotina não utiliza ΣDAT (PIXON)
```
\

## Arquivos

1. [Programa nlFIT e exemplo em cinética enzimática](/hp50g/nlFIT/nlFIT.zip)
2. [Código](/hp50g/nlFIT/nlFIT.pdf)
\

|   Para seu uso, o programa requer a entrada dos seguintes dados na sequência da pilha:
\

```{r, eval=FALSE}

# Entrada de dados

1. lista de valores de xi: {x1 x2...xn};
2. lista de valores de yi: {y1 y2 y3, ...yn};
3. lista de pesos: {w1, w2, w3, ...wn}. Obs: não havendo pesos, introduz-se uma
     lista unitária - {1 1 1...};
4. função para ajuste (ex: Vm*x/(Km+x); equação para cinética enzimática de 
     Michelis-Mentem). Obs: variável independente como "x";
5. lista de parâmetros: {p1 p2}. Obs: no exemplo, p1 = Vm e p2 = Km;
6. no. de iterações desejadas. Ex: 3
```
\

|   Junto ao arquivo comprimido segue um exemplo em cinética enzimática para ilustrar seu uso:

o uso.
\
```{r, eval = FALSE}
# Uso do programa

1. Clique em EVAL no arquivo de exemplo para liberar as listas necessárias de input;
2. Clique em "nlFIT" para executar o programa;

OBS: Para dados de usuário, basta substituir as listas.
```


## Resultados

::: {#fig-nlFIT layout-ncol=2}

![Resultados](results.png){#fig-result}

![Gráfico de pontos e ajuste não linear](plot.png){#fig-plot}

Telas da HP50G apresentando os resultados de texto e gráfico do *nlFIT*.

:::


## Reference {.unnumbered}

Coffin, Dan. Calculus on the HP 48G/GX. Grapevine Publications, 1995.