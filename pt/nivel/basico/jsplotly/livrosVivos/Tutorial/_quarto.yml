project:
  type: book

book:
  title: "Usando o JSPlotly"
#  author: "Norah Jones"
#  date: "9/22/2025"
  chapters:
    - index.qmd
    - introducao.qmd # tela e funções
    - interatividade.qmd
    # - potencial.qmd # gráficos, mapas, anima, simul
    # - graficos.qmd
    # - mapas.qmd
    # - outros.qmd
#    - intro.qmd
#    - summary.qmd
#    - living.qmd

    # - referencias.qmd

bibliography: references.bib



lang: pt

format:
  html:
    theme: #bootstrap
      light: [zephyr, theme.scss]   # escolha o Bootswatch que quiser
      dark:  [slate,  theme.scss]   # tema escuro opcional
 
    page-layout: full     # dá espaço horizontal
    toc: false          # tira TOC da margem
  pdf:
    documentclass: scrreprt
sidebar: true          # esconde sidebar do sumário nesta página


resources:
#  - JSPlotly2q.html
  - apps/**               # (se você guardar outros em apps/)

########### ícone para sidebar

# --- INÍCIO: include em um ÚNICO bloco unificado ---
include-in-header:
  - text: |
      <style>
         /* ===== largura máxima do conteúdo ===== */
        :root { --content-max-width: 1600px; }

        /* ===== cores utilitárias (suas classes) ===== */
        .red  { color: #e53935; }
        .blue { color: dodgerblue; }
        .darkblue  { color: #003366; }   /* azul escuro */
        .darkgreen { color: #006400; }   /* verde escuro */
        .orange    { color: #ff8c00; }   /* laranja */
        .purple    { color: #800080; }   /* roxo */
        .note { color:#6f42c1; background:#f3e8ff; padding:2px 6px; border-radius:6px; }

        /* ===== BOTÃO CENTRAL personalizável ===== */
        #qst-centered {
          position: fixed;
          top: 12px;
          left: 50%;
          transform: translateX(-50%);
          z-index: 1031;
          display: inline-flex;
          align-items: center;
          justify-content: center;
          width: 36px;
          height: 36px;
          border-radius: 999px;
          background: #fff;
          border: 1px solid #e6ecf3;
          box-shadow: 0 2px 8px rgba(0,0,0,.08);
          cursor: pointer;
        }
        #qst-centered:hover {
          box-shadow: 0 3px 12px rgba(0,0,0,.12);
          border-color: #d8e2ef;
        }
        #qst-centered .qst-bar {
          width: 18px; height: 2px; background:#333; margin: 2px 0;
        }

        /* Em telas pequenas, deixe o comportamento padrão do tema */
        @media (max-width: 991.98px){
          #qst-centered { display: none; }
        }

        /* Evitar que o botão sobreponha o H1 ao navegar por âncoras */
        .content h1.title, .content h1 { scroll-margin-top: 60px; }
      </style>
      
      

      <script>
        document.addEventListener('DOMContentLoaded', function () {
          // 1) Verifique se o include carregou: deve haver o quadradinho verde no canto (body::after)
          // 2) Criar um botão central próprio (independente do botão do tema)
          if (!document.getElementById('qst-centered')) {
            const b = document.createElement('button');
            b.id = 'qst-centered';
            b.setAttribute('type','button');
            b.setAttribute('title','Mostrar/ocultar barra lateral');

            for (let i=0;i<3;i++){
              const bar = document.createElement('div');
              bar.className = 'qst-bar';
              b.appendChild(bar);
            }
            document.body.appendChild(b);

            // Handler do clique: alterna o estado do sidebar usando Bootstrap Collapse
            b.addEventListener('click', () => {
              try {
                const sidebar = document.querySelector('#quarto-sidebar');
                const body = document.body;

                // alterna uma classe no body (útil para temas que usam isso)
                body.classList.toggle('sidebar-collapsed');

                if (sidebar) {
                  // se estiver colapsado, mostramos; se estiver aberto, escondemos
                  const isOpen = sidebar.classList.contains('show');
                  // tenta usar a API do Bootstrap, se estiver presente
                  const bs = (window.bootstrap && window.bootstrap.Collapse)
                    ? window.bootstrap.Collapse.getOrCreateInstance(sidebar)
                    : null;

                  if (bs) {
                    if (isOpen) { bs.hide(); } else { bs.show(); }
                  } else {
                    // fallback: alterna class "show" manualmente
                    sidebar.classList.toggle('show');
                  }

                  // mantém a classe do body coerente
                  if (sidebar.classList.contains('show')) {
                    body.classList.remove('sidebar-collapsed');
                  } else {
                    body.classList.add('sidebar-collapsed');
                  }
                }
              } catch (e) {
                console.warn('Toggle central falhou:', e);
              }
            });
          }
        });
      </script>
      
  - text: |
      <script>
        (function(){
          function pickVisible(el){ return el && el.offsetParent !== null; }

          function findNativeToggle(){
            // 1) seletores “clássicos” do Quarto (cobrindo variações)
            const sels = [
              '#quarto-sidebar-toggle',
              '.quarto-sidebar-toggle',
              'button.sidebar-toggle',
              'button[aria-controls="quarto-sidebar"]',
              'a[aria-controls="quarto-sidebar"]',
              '[data-bs-target="#quarto-sidebar"]',
              '[aria-label*="sidebar" i]'
            ];
            for (const s of sels){
              const el = document.querySelector(s);
              if (pickVisible(el)) return el;
            }

            // 2) Heurística: procura um botão pequeno no canto sup. esquerdo
            const candidates = Array.from(document.querySelectorAll('button, a, .btn'));
            const ranked = candidates
              .map(el => [el, el.getBoundingClientRect()])
              .filter(([el, r]) => r.width > 20 && r.width < 64 && r.height > 20 && r.height < 64 && r.top >= 0 && r.top < 120 && r.left >= 0 && r.left < 140)
              .sort((a,b) => (a[1].top - b[1].top) || (a[1].left - b[1].left));
            return ranked.length ? ranked[0][0] : null;
          }

          function moveNativeToggle(){
            const btn = findNativeToggle();
            if (!btn) return;

            // reposiciona o PRÓPRIO botão nativo
            btn.style.position   = 'fixed';
            btn.style.left       = '50%';
            btn.style.top        = '12px';
            btn.style.transform  = 'translateX(-50%)';
            btn.style.zIndex     = '1060';

            // estética opcional (remova se quiser o padrão do tema)
            btn.style.background = '#fff';
            btn.style.border     = '1px solid #e6ecf3';
            btn.style.boxShadow  = '0 2px 8px rgba(0,0,0,.08)';
            btn.style.borderRadius = '999px';
            btn.style.width      = '36px';
            btn.style.height     = '36px';
            btn.style.display    = 'inline-flex';
            btn.style.alignItems = 'center';
            btn.style.justifyContent = 'center';
            btn.style.padding    = '0';
          }

          function wire(){
            moveNativeToggle();
            // se o DOM mudar (p.ex. render tardio), tentamos de novo
            const obs = new MutationObserver(() => moveNativeToggle());
            obs.observe(document.body, {childList:true, subtree:true});
            // também ao redimensionar
            window.addEventListener('resize', moveNativeToggle);
          }

          if (document.readyState === 'loading'){
            document.addEventListener('DOMContentLoaded', wire);
          } else {
            wire();
          }
        })();
      </script>

      <style>
        /* Esconde o botão nativo original no canto ESQUERDO em telas médias+,
           caso ele reapareça por algum motivo (opcional). */
        @media (min-width: 992px){
          .sidebar .quarto-sidebar-toggle,
          .sidebar #quarto-sidebar-toggle,
          .sidebar button.sidebar-toggle{ visibility:hidden !important; }
        }
        /* Em telas pequenas, deixe como está (botão no canto esq.) */
        @media (max-width: 991.98px){
          /* nada aqui: usamos o padrão do tema */
        }
      </style>
      
  - text: |
      <style>
        /* ===== LARGURA MENOR PARA SIDEBAR E TOC =====
           Aplica só em telas médias/grandes para não atrapalhar mobile */
        @media (min-width: 992px){

          /* (1) Se o seu Quarto expõe variáveis, use-as (fica mais limpo) */
          :root{
            --sidebar-width: 220px;            /* esquerda */
            --margin-sidebar-width: 240px;     /* TOC à direita */
          }

          /* (2) Fallback robusto (quando tema/versão não usa as variáveis) */
          #quarto-sidebar{
            width: var(--sidebar-width) !important;
          }
          /* alguns temas têm contêiner interno com largura própria */
          #quarto-sidebar .sidebar,
          #quarto-sidebar .sidebar-content,
          .sidebar.sidebar-navigation{
            width: var(--sidebar-width) !important;
            max-width: var(--sidebar-width) !important;
          }

          /* TOC / margin sidebar (direita) */
          #quarto-margin-sidebar{
            width: var(--margin-sidebar-width) !important;
          }
          .margin-sidebar{
            width: var(--margin-sidebar-width) !important;
            max-width: var(--margin-sidebar-width) !important;
          }

          /* (3) Diminui o espaço entre as 3 colunas (sidebar | conteúdo | TOC) */
          #quarto-content.page-columns{
            column-gap: 14px !important;  /* experimente 10–18px */
          }

          /* (4) Conteúdo central sem “colchões” extras */
          main.content{
            padding-left: 0 !important;
            padding-right: 0 !important;
          }

          /* (5) Só estética: o search acompanha a nova largura */
          #quarto-sidebar input.sidebar-search{
            width: 100% !important;
          }
        }
      </style>
      

# Dicas rápidas: Quer ainda mais área central? reduza para --sidebar-width: 200px e --margin-sidebar-width: 220px. Quer um visual mais “fino”? baixe column-gap para 12px ou 10px.
      
  - text: |
      <style>
        /* ===== Preenche melhor a área central ===== */
        @media (min-width: 992px){

          /* use os mesmos valores que você já está usando
             para sidebar e TOC (ou deixe estes) */
          :root{
            --sidebar-width: 220px;
            --margin-sidebar-width: 240px;
          }

          /* gap entre colunas + “almofada” lateral de página (gutters) */
          :root{
            --lv-gap: 14px;       /* mesmo column-gap que você definiu */
            --lv-page-pad: 12px;  /* gutters externos (um de cada lado) */
          }

          /* Faz o track do conteúdo central ocupar todo o restante da tela */
          :root{
            --content-max-width: calc(
              100vw
              - var(--sidebar-width)
              - var(--margin-sidebar-width)
              - (2 * var(--lv-gap))
              - (2 * var(--lv-page-pad))
            ) !important;
          }

          /* Garante que o elemento não imponha um max-width menor */
          main.content{
            max-width: none !important;
            padding-left: 0 !important;
            padding-right: 0 !important;
          }

          /* Ajusta o espaçamento entre as 3 colunas */
          #quarto-content.page-columns{
            column-gap: var(--lv-gap) !important;
          }

          /* Opcional: controla os gutters externos (margens da página) */
          .page-columns{
            padding-left: var(--lv-page-pad) !important;
            padding-right: var(--lv-page-pad) !important;
          }
        }
      </style>
      
# Diminua --sidebar-width e/ou --margin-sidebar-width, ou reduza --lv-gap para 12px / 10px. Ainda sobrou um respiro que você não quer? Diminua --lv-page-pad (os gutters externos) para 8px ou 6px.


  - text: | 

      <style>
        /* ===== Ajuste seguro de larguras sem redesenhar o grid ===== */
        @media (min-width: 992px){
          /* 1) larguras das colunas do Quarto */
          :root{
            /* sidebar (esquerda) e TOC (direita) */
            --sidebar-width:           220px;  /* ajuste aqui, ex: 200-240 */
            --margin-sidebar-width:    240px;  /* TOC; ajuste aqui, ex: 220-260 */

            /* largura máxima do conteúdo (miolo) — pode ser grande */
            --content-max-width:       2000px; /* evita “miolo” estreito */
          }

          /* 2) aplica os valores sem mexer no grid */
          #quarto-sidebar{
            width: var(--sidebar-width) !important;
            min-width: var(--sidebar-width) !important;
          }
          #quarto-margin-sidebar{
            width: var(--margin-sidebar-width) !important;
            min-width: var(--margin-sidebar-width) !important;
          }

          /* 3) respiro e liberação de largura no conteúdo */
          main.content{
            max-width: none !important;          /* ignora limites herdados */
            padding-left:  14px !important;      /* “respiro” interno */
            padding-right: 14px !important;
            overflow: visible !important;        /* não corta texto nas bordas */
            box-sizing: border-box !important;
          }

          /* 4) diminui o espaço entre colunas (sem trocar ordem) */
          #quarto-content.page-columns{
            column-gap: 14px !important;         /* ajuste: 10–16px */
          }
        }

        /* Em telas pequenas, deixa o padrão móvel */
        @media (max-width: 991.98px){
          main.content{
            padding-left: 12px !important;
            padding-right: 12px !important;
          }
        }
      </style>

# /* Dicas: Se quiser mais área central, reduza --sidebar-width e/ou --margin-sidebar-width (ex.: 200px e 220px). Se o texto ainda ficar “colado”, aumente o padding-left/right de main.content. Se algo continuar estranho, me manda um print de página inteira e eu calibro os seletores pro seu tema específico.*/


  # - text: |
  #     <style>
  #       /* ===== Correções para telas pequenas (celular) ===== */
  #       @media (max-width: 991.98px){
  # 
  #         /* 1) Some com o TOC direito para liberar largura */
  #         #quarto-margin-sidebar{
  #           display: none !important;
  #         }
  # 
  #         /* 2) Garante respiro nas laterais e ocupa 100% da viewport */
  #         main.content{
  #           max-width: none !important;
  #           width: 100% !important;
  #           padding-left: 14px !important;
  #           padding-right: 14px !important;
  #           box-sizing: border-box !important;
  #         }
  # 
  #         /* 3) Evita “salto” de layout pelo gap das colunas */
  #         #quarto-content.page-columns{
  #           column-gap: 10px !important;
  #           max-width: 100vw !important;
  #         }
  # 
  #         /* 4) Impede qualquer scroll horizontal do site */
  #         html, body{
  #           overflow-x: hidden !important;
  #         }
  # 
  #         /* 5) Todo conteúdo embutido deve respeitar a largura da tela */
  #         img, video, canvas, svg{
  #           max-width: 100% !important;
  #           height: auto !important;
  #         }
  #         iframe{
  #           width: 100% !important;
  #           max-width: 100% !important;
  #           /* se seus iframes forem muito altos, pode usar um aspect-ratio: */
  #           /* aspect-ratio: 16 / 9; height: auto; */
  #         }
  # 
  #         /* 6) Código e tabelas: rolagem horizontal em vez de cortar texto */
  #         pre, code{
  #           white-space: pre-wrap !important;
  #           word-break: break-word !important;
  #         }
  #         pre code{
  #           white-space: pre-wrap !important;
  #         }
  #         .cell-output-display, .table-responsive, table{
  #           overflow-x: auto !important;
  #           display: block !important;
  #           max-width: 100% !important;
  #         }
  # 
  #         /* 7) Sidebar móvel: largura confortável como off-canvas */
  #         #quarto-sidebar{
  #           width: 86vw !important;         /* ajuste se quiser mais/menos */
  #           max-width: 420px !important;
  #         }
  #       }
  #     </style>
  # 
  # 

# --- FIM do include unificado ---


# ...seu YAML...
include-after-body:
  text: |
    <button id="sb-toggle" class="btn btn-light" title="Sidebar" aria-label="Sidebar">
      <i class="bi bi-layout-text-sidebar-reverse"></i>
    </button>

    <style>
      /* Botão fixo: não interfere no layout */
      #sb-toggle{
        position: fixed; top: 12px; left: 12px; z-index: 10000;
        border-radius: 999px; padding: 8px 10px; box-shadow: 0 4px 10px rgba(0,0,0,.15);
      }

      /* Quando a classe estiver no body, sumir com sidebars e ocupar largura total */
      body.sb-hidden #quarto-sidebar,
      body.sb-hidden #quarto-sidebar-glass,
      body.sb-hidden #quarto-margin-sidebar { display: none !important; }

      /* Grid do Quarto: faz o main ocupar tudo quando sidebar está oculta */
      body.sb-hidden .page-columns { grid-template-columns: 1fr !important; }
      body.sb-hidden main.content { grid-column: 1 / -1 !important; }
    </style>

    <script type="module">
      const BODY = document.body;
      const btn  = document.getElementById('sb-toggle');

      // restaura preferência
      if (localStorage.getItem('sb-hidden') === '1') BODY.classList.add('sb-hidden');

      const sync = () => localStorage.setItem('sb-hidden', BODY.classList.contains('sb-hidden') ? '1' : '0');

      btn?.addEventListener('click', () => { BODY.classList.toggle('sb-hidden'); sync(); });

      // atalho S (fora de inputs)
      document.addEventListener('keydown', ev => {
        if (ev.key.toLowerCase() === 's' && !ev.target.closest('input, textarea, [contenteditable="true"]')) {
          ev.preventDefault(); btn.click();
        }
      });

      // se o botão nativo do Quarto existir, manter estados sincronizados
      const hdrBtn = document.querySelector('header .quarto-btn-toggle');
      hdrBtn?.addEventListener('click', () => setTimeout(sync, 200));
    </script>
    

execute:
  cache: true
  message: false
  warning: false





